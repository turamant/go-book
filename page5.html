<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/css/main.css">
    <title>Page 2</title>
</head>
<body> 
<h1>Структура и организация проекта</h1>
<p>Прежде чем мы добавим код в наш файл main.go, самое время подумать, как организовать
    и структурировать этот проект.</p>
<p>Важно заранее объяснить, что не существует единственно правильного — или даже рекомендуемого — способа
    структурировать веб-приложения в Go. И это и хорошо, и плохо. Это означает, что у вас есть
    свобода и гибкость в том, как вы организуете свой код, но также легко застрять
    в кроличьей норе неопределенности, пытаясь решить, какой должна быть лучшая структура.</p>
<p>По мере того, как вы приобретете опыт работы с Go, вы почувствуете, какие шаблоны хорошо работают для вас в
    различных ситуациях. Но в качестве отправной точки лучший совет, который я могу вам дать, — не усложняйте слишком много. Старайтесь добавлять структуру и сложность только тогда, когда это очевидно.
    нужный.</p>
<p>Для этого проекта мы реализуем структуру схемы, которая следует популярному и проверенному подходу. Это надежная отправная точка, и вы сможете повторно использовать общую
    структуру в самых разных проектах.</p>
<p>Если вы следуете инструкциям, убедитесь, что вы находитесь в корневом каталоге репозитория вашего проекта, и
    выполните следующие команды:</p>
<pre><code>$ cd $HOME/code/snippetbox
    $ rm main.go
    $ mkdir -p cmd/web pkg ui/html ui/static
    $ touch cmd/web/main.go
    $ touch cmd/web/handlers.go</code></pre>
<p>Структура репозитория вашего проекта теперь должна выглядеть так:</p>
<p><img src="static/images/picture2.7.png"/></p>
<p>Давайте обсудим, для чего будет использоваться каждый из этих каталогов.</p>
<ul>
    <li>Каталог cmd будет содержать специфичный для приложения код для исполняемых
        приложений в проекте. На данный момент у нас будет только одно исполняемое приложение —
        веб-приложение, которое будет находиться в каталоге cmd/web.
    </li>
    <li>Каталог pkg будет содержать вспомогательный код, не относящийся к конкретному приложению, используемый в
        проекте. Мы будем использовать его для хранения потенциально повторно используемого кода, такого как помощники проверки и модели базы данных SQL
        для проекта.
    </li>
    <li>Каталог ui будет содержать активы пользовательского интерфейса, используемые веб-приложением.
        В частности, каталог ui/html будет содержать шаблоны HTML, а каталог ui/static
        каталог будет содержать статические файлы (например, CSS и изображения).
    </li>
</ul>
<p>Итак, почему мы используем эту структуру?</p>
<p>Есть два больших преимущества:</p>
<ol>
    <li>Это дает четкое разделение между активами Go и non-Go. Весь код Go, который мы напишем, будет
        находиться исключительно в каталогах cmd и pkg, оставляя корневой каталог проекта свободным для хранения
        ресурсов, не относящихся к Go, таких как файлы пользовательского интерфейса, make-файлы и определения модулей (включая наш файл go.mod).
        Это может упростить управление, когда дело доходит до создания и развертывания вашего
        приложения в будущем.
    </li>
    <li>Он очень хорошо масштабируется, если вы хотите добавить еще одно исполняемое приложение в свой проект. Например, вы можете добавить CLI (интерфейс командной строки) для автоматизации некоторых
        административные задачи в будущем. С этой структурой вы можете создать это
        приложение CLI в cmd/cli, и оно сможет импортировать и повторно использовать весь код, который вы
        написали в каталоге pkg.
    </li>
</ol>
<p>Например, вы можете добавить CLI (интерфейс командной строки) для автоматизации некоторых
    административных задач в будущем. С помощью этой структуры вы можете создать это CLI-
    приложение в cmd/cli, и оно сможет импортировать и повторно использовать весь написанный вами код
    в каталоге pkg.</p>
<h2>Рефакторинг существующего кода</h2>
<p>Давайте быстро перенесем код, который мы уже написали, для использования этой новой структуры.</p>

<pre><code>File: cmd/web/main.go
    package main
    import (
    "log"
    "net/http"
    )
    func main() {
    mux := http.NewServeMux()
    mux.HandleFunc("/", home)
    mux.HandleFunc("/snippet", showSnippet)
    mux.HandleFunc("/snippet/create", createSnippet)
    log.Println("Starting server on :4000")
    err := http.ListenAndServe(":4000", mux)
    log.Fatal(err)
}</code></pre>
<pre><code>File: cmd/web/handlers.go
    package main
    import (
    "fmt"
    "net/http"
    "strconv"
    )
    func home(w http.ResponseWriter, r *http.Request) {
    if r.URL.Path != "/" {
    http.NotFound(w, r)
    return
    }
    w.Write([]byte("Hello from Snippetbox"))
    }
    func showSnippet(w http.ResponseWriter, r *http.Request) {
    id, err := strconv.Atoi(r.URL.Query().Get("id"))
    if err != nil || id < 1 {
    http.NotFound(w, r)
    return
    }
    fmt.Fprintf(w, "Display a specific snippet with ID %d...", id)
    }
    func createSnippet(w http.ResponseWriter, r *http.Request) {
    if r.Method != http.MethodPost {
    w.Header().Set("Allow", http.MethodPost)
    http.Error(w, "Method Not Allowed", 405)
    return
    }
    w.Write([]byte("Create a new snippet..."))
}</code></pre>
<p>Итак, теперь наше веб-приложение состоит из нескольких файлов исходного кода Go в
    каталоге cmd/web. Чтобы запустить их, мы можем использовать команду go run следующим образом:</p>

<pre><code>$ cd $HOME/code/snippetbox
    $ go run ./cmd/web
    2023/08/02 17:24:28 Starting server on :4000</code></pre>

</body>
</html>